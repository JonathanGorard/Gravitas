(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    343223,       8217]
NotebookOptionsPosition[    342865,       8203]
NotebookOutlinePosition[    343267,       8219]
CellTagsIndexPosition[    343224,       8216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SolveElectrovacuumEinsteinEquations", "[", 
   RowBox[{"electromagneticTensor_", "[", 
    RowBox[{
     RowBox[{"metricTensor_", "[", 
      RowBox[{
      "matrixRepresentation_List", ",", "coordinates_List", ",", 
       "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
     "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
     "index1_", ",", "index2_"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"ElectromagneticTensor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
        RowBox[{
        "matrixRepresentation", ",", "coordinates", ",", "metricIndex1", ",", 
         "metricIndex2"}], "]"}], ",", "electromagneticPotential", ",", 
       "vacuumPermeability", ",", "index1", ",", "index2"}], "]"}], ",", 
     "\"\<\[FormalCapitalLambda]\>\""}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveElectrovacuumEinsteinEquations", "[", 
   RowBox[{
    RowBox[{"electromagneticTensor_", "[", 
     RowBox[{
      RowBox[{"metricTensor_", "[", 
       RowBox[{
       "matrixRepresentation_List", ",", "coordinates_List", ",", 
        "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
      "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
      "index1_", ",", "index2_"}], "]"}], ",", 
    RowBox[{"metricTensor_", "[", 
     RowBox[{
     "newMatrixRepresentation_List", ",", "newCoordinates_List", ",", 
      "newMetricIndex1_", ",", "newMetricIndex2_"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"ElectromagneticTensor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
        RowBox[{
        "newMatrixRepresentation", ",", "newCoordinates", ",", 
         "newMetricIndex1", ",", "newMetricIndex2"}], "]"}], ",", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"coordinates", "->", "newCoordinates"}], "]"}]}], ",", 
       RowBox[{"vacuumPermeability", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"coordinates", "->", "newCoordinates"}], "]"}]}], ",", 
       "index1", ",", "index2"}], "]"}], ",", 
     "\"\<\[FormalCapitalLambda]\>\""}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "newMatrixRepresentation", "]"}], "]"}], "==",
       "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "newCoordinates", "]"}], "==", 
      RowBox[{"Length", "[", "newMatrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "newMetricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "newMetricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "newMatrixRepresentation", "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveElectrovacuumEinsteinEquations", "[", 
   RowBox[{
    RowBox[{"electromagneticTensor_", "[", 
     RowBox[{
      RowBox[{"metricTensor_", "[", 
       RowBox[{
       "matrixRepresentation_List", ",", "coordinates_List", ",", 
        "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
      "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
      "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"ElectromagneticTensor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
        RowBox[{
        "matrixRepresentation", ",", "coordinates", ",", "metricIndex1", ",", 
         "metricIndex2"}], "]"}], ",", "electromagneticPotential", ",", 
       "vacuumPermeability", ",", "index1", ",", "index2"}], "]"}], ",", 
     "cosmologicalConstant"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SolveElectrovacuumEinsteinEquations", "[", 
   RowBox[{
    RowBox[{"electromagneticTensor_", "[", 
     RowBox[{
      RowBox[{"metricTensor_", "[", 
       RowBox[{
       "matrixRepresentation_List", ",", "coordinates_List", ",", 
        "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
      "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
      "index1_", ",", "index2_"}], "]"}], ",", 
    RowBox[{"metricTensor_", "[", 
     RowBox[{
     "newMatrixRepresentation_List", ",", "newCoordinates_List", ",", 
      "newMetricIndex1_", ",", "newMetricIndex2_"}], "]"}], ",", 
    "cosmologicalConstant_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"ElectromagneticTensor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
        RowBox[{
        "newMatrixRepresentation", ",", "newCoordinates", ",", 
         "newMetricIndex1", ",", "newMetricIndex2"}], "]"}], ",", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"coordinates", "->", "newCoordinates"}], "]"}]}], ",", 
       RowBox[{"vacuumPermeability", "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"coordinates", "->", "newCoordinates"}], "]"}]}], ",", 
       "index1", ",", "index2"}], "]"}], ",", "cosmologicalConstant"}], "]"}],
    "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "newMatrixRepresentation", "]"}], "]"}], "==",
       "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "newCoordinates", "]"}], "==", 
      RowBox[{"Length", "[", "newMatrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "newMetricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "newMetricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "newMatrixRepresentation", "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<FieldEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor", ",", "einsteinEquations"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"einsteinEquations", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Catenate", "[", 
           RowBox[{"ricciTensor", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
              "matrixRepresentation"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
             ")"}]}], "]"}], "==", 
          RowBox[{"Catenate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}], "*", 
            "covariantStressEnergyTensor"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"einsteinEquations", "===", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"einsteinEquations", "===", "False"}], ",", 
          "\[IndentingNewLine]", "Indeterminate", ",", "\[IndentingNewLine]", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"einsteinEquations", ",", 
                RowBox[{
                 RowBox[{"#", "===", "False"}], "&"}]}], "]"}], "]"}], ">", 
             "0"}], ",", "\[IndentingNewLine]", "Indeterminate", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Reverse", "/@", 
              RowBox[{"(", 
               RowBox[{"Sort", "/@", 
                RowBox[{"Select", "[", 
                 RowBox[{"einsteinEquations", ",", 
                  RowBox[{
                   RowBox[{"#", "=!=", "True"}], "&"}]}], "]"}]}], ")"}]}], 
             "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<EinsteinEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Catenate", "[", 
         RowBox[{"ricciTensor", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
            "matrixRepresentation"}], ")"}], "+", 
          RowBox[{"(", 
           RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
           ")"}]}], "]"}], "==", 
        RowBox[{"Catenate", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"8", "*", "Pi"}], ")"}], "*", 
          "covariantStressEnergyTensor"}], "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ReducedEinsteinEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Catenate", "[", 
          RowBox[{"ricciTensor", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
             "matrixRepresentation"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
            ")"}]}], "]"}], "==", 
         RowBox[{"Catenate", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "*", "Pi"}], ")"}], "*", 
           "covariantStressEnergyTensor"}], "]"}]}], "]"}], "]"}]}]}], "]"}], 
   "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<SymbolicEinsteinEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Inactive", "[", "D", "]"}], "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{
                  RowBox[{"Inactive", "[", "D", "]"}], "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Inactive", "[", "D", "]"}], "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{
                 RowBox[{"Inactive", "[", "D", "]"}], "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Catenate", "[", 
         RowBox[{"ricciTensor", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
            "matrixRepresentation"}], ")"}], "+", 
          RowBox[{"(", 
           RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
           ")"}]}], "]"}], "==", 
        RowBox[{"Catenate", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"8", "*", "Pi"}], ")"}], "*", 
          "covariantStressEnergyTensor"}], "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ContinuityEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], "]"}],
                   ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"index", "=", "#"}], "}"}], ",", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"nestedIndex", "=", "#"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "index"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "nestedIndex", "]"}], "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "nestedIndex", ",", "#"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "index"}], "]"}], "]"}]}], ")"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex", ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "#"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                "]"}]}], "]"}], "==", "0"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
          "]"}]}], ")"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ReducedContinuityEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], "]"}],
                   ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"nestedIndex", "=", "#"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "index"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "nestedIndex", "]"}], "]"}]}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "nestedIndex", ",", "#"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "index"}], "]"}], "]"}]}], ")"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex", ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "#"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}], "==", "0"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], ")"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<SymbolicContinuityEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "D", "]"}], "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{
                RowBox[{"Inactive", "[", "D", "]"}], "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], "]"}],
                   ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"index", "=", "#"}], "}"}], ",", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"nestedIndex", "=", "#"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inactive", "[", "D", "]"}], "[", 
                    RowBox[{
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "index"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "nestedIndex", "]"}], "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "nestedIndex", ",", "#"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "index"}], "]"}], "]"}]}], ")"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex", ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "#"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                "]"}]}], "]"}], "==", "0"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
          "]"}]}], ")"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<InhomogeneousMaxwellEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "electromagneticDisplacementTensor", ",", "currentDensity"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], "]"}],
                   ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"electromagneticDisplacementTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", 
            RowBox[{"Det", "[", "newMatrixRepresentation", "]"}]}], "]"}], 
          "/", "vacuumPermeability"}], ")"}], "*", 
        "contravariantElectromagneticTensor"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"currentDensity", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"electromagneticDisplacementTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"index", "=", "#"}], "}"}], ",", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"nestedIndex", "=", "#"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "nestedIndex", "]"}], "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex", ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "nestedIndex"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "nestedIndex", ",", "#"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}]}], ")"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                "]"}]}], "]"}], "==", 
             RowBox[{"vacuumPermeability", "*", 
              RowBox[{"currentDensity", "[", 
               RowBox[{"[", "index", "]"}], "]"}]}]}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
          "]"}]}], ")"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ReducedInhomogeneousMaxwellEquations\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "electromagneticDisplacementTensor", ",", "currentDensity"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], "]"}],
                   ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"electromagneticDisplacementTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", 
            RowBox[{"Det", "[", "newMatrixRepresentation", "]"}]}], "]"}], 
          "/", "vacuumPermeability"}], ")"}], "*", 
        "contravariantElectromagneticTensor"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"currentDensity", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"electromagneticDisplacementTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"nestedIndex", "=", "#"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "nestedIndex", "]"}], "]"}]}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "nestedIndex", ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "nestedIndex"}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"nestedIndex", ",", "nestedIndex", ",", "#"}], 
                    "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}]}], ")"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}], "==", 
              RowBox[{"vacuumPermeability", "*", 
               RowBox[{"currentDensity", "[", 
                RowBox[{"[", "index", "]"}], "]"}]}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], ")"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ChargeConservationEquation\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "electromagneticDisplacementTensor", ",", "currentDensity"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"electromagneticDisplacementTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", 
            RowBox[{"Det", "[", "newMatrixRepresentation", "]"}]}], "]"}], 
          "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                  "&"}], "/@", 
                 RowBox[{"Tuples", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentDensity", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"electromagneticDisplacementTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"currentDensity", "[", 
                  RowBox[{"[", "index", "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", "index", "]"}], "]"}]}], "]"}], "+", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "index", ",", "#"}], "]"}], "]"}], 
                    "*", 
                    RowBox[{"currentDensity", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "newElectromagneticPotential", "]"}],
                   "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
            "]"}]}], "]"}], "==", "0"}], ")"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ToExpression", "[", "#", "]"}], ")"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ReducedChargeConservationEquation\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "electromagneticDisplacementTensor", ",", "currentDensity"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
               "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"covariantElectromagneticPotential", "[", 
                  RowBox[{"[", 
                   RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"newCoordinates", "[", 
                  RowBox[{"[", 
                   RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
              ")"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"electromagneticDisplacementTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", 
            RowBox[{"Det", "[", "newMatrixRepresentation", "]"}]}], "]"}], 
          "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                  "&"}], "/@", 
                 RowBox[{"Tuples", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{
                    "Length", "[", "newElectromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentDensity", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"electromagneticDisplacementTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"index", "=", "#"}], "}"}], ",", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"currentDensity", "[", 
                   RowBox[{"[", "index", "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", "index", "]"}], "]"}]}], "]"}], "+", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "index", ",", "#"}], "]"}], "]"}], 
                    "*", 
                    RowBox[{"currentDensity", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{
                   "Length", "[", "newElectromagneticPotential", "]"}], 
                   "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
             "]"}]}], "]"}], "==", "0"}], ")"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<MetricTensor\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
    RowBox[{
    "matrixRepresentation", ",", "coordinates", ",", "metricIndex1", ",", 
     "metricIndex2"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ElectromagneticTensor\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"ElectromagneticTensor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
      RowBox[{
      "matrixRepresentation", ",", "coordinates", ",", "metricIndex1", ",", 
       "metricIndex2"}], "]"}], ",", "electromagneticPotential", ",", 
     "vacuumPermeability", ",", "index1", ",", "index2"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ElectromagneticStressEnergyTensor\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "covariantElectromagneticPotential", ",", 
       "tensorRepresentation", ",", "contravariantElectromagneticTensor", ",",
        "mixedElectromagneticTensor", ",", "stressEnergyTensor"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<StressEnergyTensor\>\"", "]"}], 
       "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
         
         RowBox[{
         "matrixRepresentation", ",", "coordinates", ",", "metricIndex1", ",",
           "metricIndex2"}], "]"}], ",", "stressEnergyTensor", ",", "False", 
        ",", "False"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<Coordinates\>\"", "]"}], ":=", 
  RowBox[{"coordinates", "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeablity_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<CoordinateOneForms\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "#", "]"}], "===", "Subscript"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"\"\<\[FormalD]\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"First", "[", "#", "]"}], "]"}]}], ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"Last", "[", "#", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "#", "]"}], "===", "Superscript"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Superscript", "[", 
           RowBox[{
            RowBox[{"\"\<\[FormalD]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "[", "#", "]"}], "]"}]}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<\[FormalD]\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
      "coordinates"}], ")"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<SolutionQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor", ",", "einsteinEquations"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"einsteinEquations", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Catenate", "[", 
           RowBox[{"ricciTensor", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
              "matrixRepresentation"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
             ")"}]}], "]"}], "==", 
          RowBox[{"Catenate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}], "*", 
            "covariantStressEnergyTensor"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"einsteinEquations", "===", "True"}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"einsteinEquations", "===", "False"}], ",", 
          "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"einsteinEquations", ",", 
                RowBox[{
                 RowBox[{"#", "===", "False"}], "&"}]}], "]"}], "]"}], ">", 
             "0"}], ",", "\[IndentingNewLine]", "False", ",", 
            "\[IndentingNewLine]", "True"}], "]"}]}], "]"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<ExactSolutionQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor", ",", "einsteinEquations"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"einsteinEquations", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Catenate", "[", 
           RowBox[{"ricciTensor", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
              "matrixRepresentation"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
             ")"}]}], "]"}], "==", 
          RowBox[{"Catenate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}], "*", 
            "covariantStressEnergyTensor"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"einsteinEquations", "===", "True"}], ",", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"einsteinEquations", "===", "False"}], ",", 
          "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"einsteinEquations", ",", 
                RowBox[{
                 RowBox[{"#", "===", "False"}], "&"}]}], "]"}], "]"}], ">", 
             "0"}], ",", "\[IndentingNewLine]", "False", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"(", 
                   RowBox[{"Sort", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"einsteinEquations", ",", 
                    RowBox[{
                    RowBox[{"#", "=!=", "True"}], "&"}]}], "]"}]}], ")"}]}], 
                 "]"}], "]"}], "==", "0"}], ",", "\[IndentingNewLine]", 
              "True", ",", "\[IndentingNewLine]", "False"}], "]"}]}], "]"}]}],
          "]"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<CosmologicalConstant\>\"", "]"}], ":=", 
  RowBox[{"cosmologicalConstant", "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeablity_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<Dimensions\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", "matrixRepresentation", "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ElectrovacuumSolution", "[", 
     RowBox[{
      RowBox[{"electromagneticTensor_", "[", 
       RowBox[{
        RowBox[{"metricTensor_", "[", 
         RowBox[{
         "matrixRepresentation_List", ",", "coordinates_List", ",", 
          "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
        "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
        "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
     "]"}], "[", "\"\<Signature\>\"", "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eigenvalues", ",", "positiveEigenvalues", ",", 
        "negativeEigenvalues"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eigenvalues", "=", 
        RowBox[{"Eigenvalues", "[", "matrixRepresentation", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"positiveEigenvalues", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"eigenvalues", ",", 
          RowBox[{
           RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"negativeEigenvalues", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"eigenvalues", ",", 
          RowBox[{
           RowBox[{"#", "<", "0"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "positiveEigenvalues", "]"}], "+", 
           RowBox[{"Length", "[", "negativeEigenvalues", "]"}]}], "==", 
          RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"Length", "[", "negativeEigenvalues", "]"}]}], "]"}], 
           ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "positiveEigenvalues", "]"}]}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "Indeterminate"}], "]"}]}]}], 
     "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
       "\"\<ElectromagneticTensor\>\""}], "&&", 
      RowBox[{
       RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
       "\"\<MetricTensor\>\""}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==",
        "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", "coordinates", "]"}], "==", 
       RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
      RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
      RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
       RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
      RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
      RowBox[{"BooleanQ", "[", "index2", "]"}]}], ")"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ElectrovacuumSolution", "[", 
    RowBox[{
     RowBox[{"electromagneticTensor_", "[", 
      RowBox[{
       RowBox[{"metricTensor_", "[", 
        RowBox[{
        "matrixRepresentation_List", ",", "coordinates_List", ",", 
         "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
       "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
       "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
    "]"}], "[", "\"\<RiemannianQ\>\"", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eigenvalues", ",", "positiveEigenvalues", ",", "negativeEigenvalues"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eigenvalues", "=", 
       RowBox[{"Eigenvalues", "[", "matrixRepresentation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positiveEigenvalues", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"eigenvalues", ",", 
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"negativeEigenvalues", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"eigenvalues", ",", 
         RowBox[{
          RowBox[{"#", "<", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "positiveEigenvalues", "]"}], "+", 
          RowBox[{"Length", "[", "negativeEigenvalues", "]"}]}], "==", 
         RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "positiveEigenvalues", "]"}], "==", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "negativeEigenvalues", "]"}], "==", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
          "False"}], "]"}], ",", "\[IndentingNewLine]", "Indeterminate"}], 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ElectrovacuumSolution", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"electrovacuumSolution", ":", 
     RowBox[{"ElectrovacuumSolution", "[", 
      RowBox[{
       RowBox[{"electromagneticTensor_", "[", 
        RowBox[{
         RowBox[{"metricTensor_", "[", 
          RowBox[{
          "matrixRepresentation_List", ",", "coordinates_List", ",", 
           "metricIndex1_", ",", "metricIndex2_"}], "]"}], ",", 
         "electromagneticPotential_List", ",", "vacuumPermeability_", ",", 
         "index1_", ",", "index2_"}], "]"}], ",", "cosmologicalConstant_"}], 
      "]"}]}], ",", "format_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newMatrixRepresentation", ",", "newElectromagneticPotential", ",", 
       "newCoordinates", ",", "christoffelSymbols", ",", "riemannTensor", ",",
        "ricciTensor", ",", "ricciScalar", ",", "matrixForm", ",", 
       "covariantElectromagneticPotential", ",", "tensorRepresentation", ",", 
       "contravariantElectromagneticTensor", ",", 
       "mixedElectromagneticTensor", ",", "stressEnergyTensor", ",", 
       "covariantStressEnergyTensor", ",", "einsteinEquations", ",", 
       "solution", ",", "exactSolution", ",", "fieldEquations", ",", "icon"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newMatrixRepresentation", "=", 
       RowBox[{"matrixRepresentation", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newElectromagneticPotential", "=", 
       RowBox[{"electromagneticPotential", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newCoordinates", "=", 
       RowBox[{"coordinates", "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "->", 
             RowBox[{"ToExpression", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"christoffelSymbols", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "newMatrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}]}], ")"}],
                  "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
            ",", "3"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"riemannTensor", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
                   RowBox[{"newCoordinates", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                 "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"index", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"christoffelSymbols", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"index", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], 
                    "]"}]}], "]"}]}], ")"}]}]}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newMatrixRepresentation", "]"}], "]"}], 
             ",", "4"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ricciTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"riemannTensor", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", 
                    RowBox[{"First", "[", "index", "]"}], ",", "#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ricciScalar", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
            RowBox[{"ricciTensor", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], ",", 
               RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
          "&"}], "/@", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",", 
           "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrixForm", "=", 
       RowBox[{"(", 
        RowBox[{"ricciTensor", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
           "matrixRepresentation"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
          ")"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covariantElectromagneticPotential", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newMatrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"index", ",", "#"}], "]"}], "]"}], "*", 
                   RowBox[{"newElectromagneticPotential", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tensorRepresentation", "=", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}]}], "]"}], 
                "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covariantElectromagneticPotential", "[", 
                   RowBox[{"[", 
                    RowBox[{"First", "[", "#", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"newCoordinates", "[", 
                   RowBox[{"[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}], "]"}]}], "]"}]}], 
               ")"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newElectromagneticPotential", "]"}], 
              "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], "->", "#"}], ")"}], 
           "&"}], "/@", 
          RowBox[{"Select", "[", 
           RowBox[{"coordinates", ",", "StringQ"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"contravariantElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mixedElectromagneticTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}]}], 
                  ")"}], "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}], 
            ",", "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stressEnergyTensor", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "vacuumPermeability"}], ")"}], "*", 
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "#"}], "}"}], ",", 
              RowBox[{"index", "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}], "*", 
                    RowBox[{"mixedElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "index", "]"}], ",", "#"}], "]"}], 
                    "]"}]}], ")"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}]}], "]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "4"}], ")"}], "*", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixRepresentation", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                    
                    RowBox[{"tensorRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                    RowBox[{"contravariantElectromagneticTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "electromagneticPotential", "]"}], 
                    "]"}], ",", "2"}], "]"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "electromagneticPotential", "]"}], "]"}],
              ",", "2"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"covariantStressEnergyTensor", "=", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"index", "=", "#"}], "}"}], ",", 
             RowBox[{"index", "->", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "index", "]"}], ",", 
                    RowBox[{"First", "[", "#", "]"}]}], "]"}], "]"}], "*", 
                   RowBox[{"matrixRepresentation", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "index", "]"}]}], "]"}], "]"}], "*", 
                   
                   RowBox[{"stressEnergyTensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "[", "#", "]"}], ",", 
                    RowBox[{"Last", "[", "#", "]"}]}], "]"}], "]"}]}], ")"}], 
                 "&"}], "/@", 
                RowBox[{"Tuples", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "matrixRepresentation", "]"}], 
                   "]"}], ",", "2"}], "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", 
          
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "matrixRepresentation", "]"}], "]"}], ",",
             "2"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"einsteinEquations", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Catenate", "[", 
           RowBox[{"ricciTensor", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", "ricciScalar", "*", 
              "matrixRepresentation"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{"cosmologicalConstant", "*", "matrixRepresentation"}], 
             ")"}]}], "]"}], "==", 
          RowBox[{"Catenate", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"8", "*", "Pi"}], ")"}], "*", 
            "covariantStressEnergyTensor"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"einsteinEquations", "===", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solution", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"exactSolution", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"fieldEquations", "=", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"einsteinEquations", "===", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"solution", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"exactSolution", "=", "False"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fieldEquations", "=", "Indeterminate"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"einsteinEquations", ",", 
                RowBox[{
                 RowBox[{"#", "===", "False"}], "&"}]}], "]"}], "]"}], ">", 
             "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"solution", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"exactSolution", "=", "False"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fieldEquations", "=", "Indeterminate"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"(", 
                   RowBox[{"Sort", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"einsteinEquations", ",", 
                    RowBox[{
                    RowBox[{"#", "=!=", "True"}], "&"}]}], "]"}]}], ")"}]}], 
                 "]"}], "]"}], "==", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solution", "=", "True"}], ";", "\[IndentingNewLine]", 
               
               RowBox[{"exactSolution", "=", "True"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fieldEquations", "=", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solution", "=", "True"}], ";", "\[IndentingNewLine]", 
               
               RowBox[{"exactSolution", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"fieldEquations", "=", 
                RowBox[{"Length", "[", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Reverse", "/@", 
                   RowBox[{"(", 
                    RowBox[{"Sort", "/@", 
                    RowBox[{"Select", "[", 
                    RowBox[{"einsteinEquations", ",", 
                    RowBox[{
                    RowBox[{"#", "=!=", "True"}], "&"}]}], "]"}]}], ")"}]}], 
                  "]"}], "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"icon", "=", 
       RowBox[{"MatrixPlot", "[", 
        RowBox[{"matrixForm", ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"Dynamic", "@", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", 
             RowBox[{"3.5", "*", 
              RowBox[{
               RowBox[{"CurrentValue", "[", "\"\<FontCapHeight\>\"", "]"}], 
               "/", 
               RowBox[{
               "AbsoluteCurrentValue", "[", "Magnification", "]"}]}]}]}], 
            "}"}]}]}], ",", 
         RowBox[{"Frame", "->", "False"}], ",", 
         RowBox[{"FrameTicks", "->", "None"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BoxForm`ArrangeSummaryBox", "[", 
       RowBox[{
       "\"\<ElectrovacuumSolution\>\"", ",", "electrovacuumSolution", ",", 
        "icon", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Solution: \>\"", ",", "solution"}], "}"}], "]"}], 
            ",", 
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Exact Solution: \>\"", ",", "exactSolution"}], 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Field Equations: \>\"", ",", "fieldEquations"}], 
              "}"}], "]"}], ",", 
            RowBox[{"BoxForm`SummaryItem", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Cosmological Constant: \>\"", ",", 
               "cosmologicalConstant"}], "}"}], "]"}]}], "}"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}], ",", "format", ",", 
        RowBox[{"\"\<Interpretable\>\"", "->", "Automatic"}]}], "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SymbolName", "[", "electromagneticTensor", "]"}], "===", 
      "\"\<ElectromagneticTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"SymbolName", "[", "metricTensor", "]"}], "===", 
      "\"\<MetricTensor\>\""}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "matrixRepresentation", "]"}], "]"}], "==", 
      "2"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "coordinates", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "metricIndex2", "]"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "electromagneticPotential", "]"}], "==", 
      RowBox[{"Length", "[", "matrixRepresentation", "]"}]}], "&&", 
     RowBox[{"BooleanQ", "[", "index1", "]"}], "&&", 
     RowBox[{"BooleanQ", "[", "index2", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.891712166653303*^9, 3.891712522031926*^9}, {
   3.8917126673034153`*^9, 3.891712733433277*^9}, {3.891712808477862*^9, 
   3.891712845062531*^9}, {3.891712933545931*^9, 3.8917133266430273`*^9}, {
   3.89171336250287*^9, 3.891713754890566*^9}, {3.8917513858307343`*^9, 
   3.891751386032446*^9}, {3.891751788391506*^9, 3.89175178854523*^9}, {
   3.8917527014850483`*^9, 3.891752701642473*^9}, {3.8917570720489273`*^9, 
   3.891757072359873*^9}, {3.896653863904415*^9, 3.896653864295382*^9}, 
   3.896654244803549*^9, {3.896655144318818*^9, 3.896655144577001*^9}, {
   3.896773687161502*^9, 3.896773688243155*^9}, 3.89677380726047*^9, 
   3.896774729144878*^9, {3.8974851371578417`*^9, 3.89748513736887*^9}, {
   3.897486844485721*^9, 3.897486853839025*^9}, {3.8974888322719517`*^9, 
   3.897488832713593*^9}, 3.8974896798800993`*^9, {3.897491464888114*^9, 
   3.897491465372396*^9}, {3.89749316310364*^9, 3.897493163413863*^9}, 
   3.89749385438896*^9, 3.897494139177669*^9, {3.897494286348365*^9, 
   3.897494286601111*^9}, {3.897494850074087*^9, 3.897494850377598*^9}, 
   3.897494984677577*^9, 3.897495084045586*^9, {3.89749631459898*^9, 
   3.897496314810773*^9}, {3.897497025129627*^9, 3.8974970255102663`*^9}, {
   3.8974972322604723`*^9, 3.897497233130743*^9}, {3.897658921029055*^9, 
   3.897658921477585*^9}, {3.8991170917657413`*^9, 3.899117179874704*^9}, {
   3.899117235287531*^9, 3.899117377185136*^9}, {3.899118405953414*^9, 
   3.89911840622165*^9}, {3.900620910641096*^9, 3.900620917388818*^9}, {
   3.900675592986701*^9, 3.9006755932149487`*^9}, {3.900675665241387*^9, 
   3.900675682652335*^9}, {3.900675763407713*^9, 3.900675829963133*^9}, {
   3.900676313908996*^9, 3.9006763140948467`*^9}, {3.900702971504361*^9, 
   3.9007029716043243`*^9}, {3.900703028563178*^9, 
   3.900703028757938*^9}},ExpressionUUID->"8127f867-6bad-448a-901b-\
d0bf4bda7fec"]
},
WindowSize->{1123, 777},
WindowMargins->{{-1883, Automatic}, {Automatic, -104}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (November 1, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ab4470a3-4b35-4ae8-89c3-f953fe796889"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 342300, 8181, 26134, "Input",ExpressionUUID->"8127f867-6bad-448a-901b-d0bf4bda7fec"]
}
]
*)

